{"id":"neovim.md","title":"Neovim - PDE","date":"2023-02-22","content":"<p>I just love <strong>neovim</strong>.</p>\n<h2>Where I come from?</h2>\n<p>As a beginer windows user, obviously I have tried coding in <strong>Notepad</strong>.\nThen I used to use <strong>Notepad++</strong>.\nThen I found <strong>sublime-text</strong> and loved <strong>Monokai</strong> theme.</p>\n<p>Then I started using <strong>Linux</strong> and <strong>Netbeans</strong> with its rich language support and slowness got me.\nThen I started using <strong>Jetbrains IDE</strong>, loved its features then came <strong>vscode</strong>.\nIt changed the way I used to use text editor. With LSP, a simple editor got power of IDE.\nWith remote development plugins, now it possible to SSH into remote server and use light clients with access to powerful servers.\n<strong>vscode</strong> with <strong>WSL2</strong> started everything then SSH came along.\nThen came quarantine, during those days I used to use old laptop as home lab server and working on remote machine was my everyday.</p>\n<p>Jetbrains IDE was very slow to index my codebases but vscode was also slow.\nvscode also didn't had good support for <strong>PHP</strong> but with <strong>PHP Intelephense</strong> plugin, it is workable.\nI was missing one regulary used feature from Jetbrains IDE (ie Goto Implementation) in vscode with plugins.\nI mostly work on large codebases and there were numerious type of files, vscode was good for multiple language support. Each and every language had rich support, LSP was that good.</p>\n<p>All these years, <strong>vim</strong> was under my nose as editor in server when I am using ssh in terminal I always had vim.\nUsing vscode in client server and production server was no go due to node dependencies and <strong>vscode-server</strong> installation. Production server should be isolated and only http port should be opened.\nI have worked on some servers where one must ssh through various tunnels to finally getting into production.</p>\n<h2>Why to configure neovim?</h2>\n<p>I had to rethink about my code editor choice, then came <strong>neovim</strong> with lua script support, customization and plugins.\nAll these years after moving from one primary editor to another and testing numerious editors, I knew what I wanted but configuring neovim exectly was so hard at first.\nI configured my neovim and was missing so many features that I used to get back to vscode at beginer days.</p>\n<p>Then I found <strong>Lunarvim</strong> distro, neovim configuration was like magic.\nEverything is configured for you and most of keybinding are sane and workable.\nI still suggest beginer to use <strong>Lunarvim</strong> until you want or need to create your own config.\nIt also uses separate neovim files dir living with your own neovim config. Then one can use both and keep configuring own config until one can migrate.\nIt allows you to configure that you don't like about it and all updates are maintained by distro maintainers.\nI have use neovim for long time to see plugins deprecated and rise of suggestion for similar plugins, plugin manager changes and lots of LSP changes and updates.\nWith preconfigured neovim distro, there comes numerious features that you use or don't use. And keybindings that you don't remember.</p>\n<p>There is concept of <strong>Personal Development Environment (PDE)</strong>. And I got fond of it.\nUltimately as I use my editor all the time to code my projects, it makes sense to code my editor as well or atlease configure it to my liking.\nI got my hand issues, typing issues and I am brust typer. So, I configured my neovim according to it.</p>\n<h2>Neovim version manager</h2>\n<ul>\n<li>bob-bin</li>\n</ul>\n<h2>Package manager</h2>\n<ul>\n<li>lazy.nvim</li>\n</ul>\n<h2>Plugins</h2>\n<ul>\n<li>\n<p>nvim-telescope/telescope.nvim</p>\n</li>\n<li>\n<p>voldikss/vim-floaterm</p>\n</li>\n<li>\n<p>nvim-treesitter/nvim-treesitter</p>\n</li>\n<li>\n<p>theprimeagen/harpoon</p>\n</li>\n<li>\n<p>mbbill/undotree</p>\n</li>\n<li>\n<p>tpope/vim-fugitive</p>\n</li>\n<li>\n<p>lewis6991/gitsigns.nvim</p>\n</li>\n<li>\n<p>sindrets/diffview.nvim</p>\n</li>\n<li>\n<p>VonHeikemen/lsp-zero.nvim</p>\n</li>\n<li>\n<p>williamboman/mason.nvim</p>\n</li>\n<li>\n<p>jose-elias-alvarez/null-ls.nvim</p>\n</li>\n<li>\n<p>jayp0521/mason-null-ls.nvim</p>\n</li>\n<li>\n<p>ray-x/lsp_signature.nvim</p>\n</li>\n<li>\n<p>folke/troble.nvim</p>\n</li>\n<li>\n<p>github/copilot.vim</p>\n</li>\n<li>\n<p>mfussenegger/nvim-dap</p>\n</li>\n<li>\n<p>rcarriga/nvim-dap-ui</p>\n</li>\n<li>\n<p>numToStr/Comment.nvim</p>\n</li>\n<li>\n<p>JoosepAlviste/nvim-ts-context-commentstring</p>\n</li>\n<li>\n<p>windwp/nvim-autopairs</p>\n</li>\n<li>\n<p>lukas-reineke/indent-blankline.nvim</p>\n</li>\n<li>\n<p>tpope/vim-sleuth</p>\n</li>\n<li>\n<p>folke/neodev.nvim</p>\n</li>\n<li>\n<p>ellisonleao/glow.nvim</p>\n</li>\n<li>\n<p>nvim-lualine/lualine.nvim</p>\n</li>\n<li>\n<p>j-hui/fidget.nvim</p>\n</li>\n<li>\n<p>folke/todo-comments.nvim</p>\n</li>\n<li>\n<p>tpope/vim-dadbod</p>\n</li>\n<li>\n<p>kristijanhusak/vim-dadbod-ui</p>\n</li>\n<li>\n<p>tamago324/lir.nvim</p>\n</li>\n<li>\n<p>folke/which-key.nvim</p>\n</li>\n</ul>\n<h2>Themes</h2>\n<ul>\n<li>\n<p>folke/tokyonight.nvim</p>\n</li>\n<li>\n<p>rose-pine/neovim</p>\n</li>\n<li>\n<p>catppuccin/nvim</p>\n</li>\n</ul>\n<h2>Autocmd</h2>\n<ul>\n<li>highlight on yank</li>\n</ul>\n<pre><code class=\"language-lua\">local highlight_group = vim.api.nvim_create_augroup('YankHighlight', { clear = true })\nvim.api.nvim_create_autocmd('TextYankPost', {\n\tcallback = function()\n\t\tvim.highlight.on_yank()\n\tend,\n\tgroup = highlight_group,\n\tpattern = '*',\n})\n</code></pre>\n<ul>\n<li>Different indent for file type</li>\n</ul>\n<pre><code class=\"language-lua\">vim.api.nvim_command [[\n\tautocmd FileType json,js,jsx,javascript,ts,tsx,typescript,typescriptreact,css,less,scss set tabstop=2\n]]\n</code></pre>\n<ul>\n<li>auto indent bug fix for PHP</li>\n</ul>\n<pre><code class=\"language-lua\">vim.api.nvim_create_autocmd({ &quot;BufWinEnter&quot; }, {\n\tcallback = function()\n\t\tvim.cmd &quot;set autoindent&quot;\n\tend\n})\n</code></pre>\n<h2>Keybinding</h2>\n<p>I use which-key for keymap documentation.</p>\n<ul>\n<li>Save current buffer</li>\n</ul>\n<pre><code class=\"language-lua\">vim.keymap.set(&quot;i&quot;, &quot;&lt;C-s&gt;&quot;, &quot;&lt;Esc&gt;:w&lt;CR&gt;&quot;)\nvim.keymap.set(&quot;n&quot;, &quot;&lt;C-s&gt;&quot;, &quot;:w&lt;CR&gt;&quot;)\n</code></pre>\n<ul>\n<li>lir explorer</li>\n</ul>\n<pre><code class=\"language-lua\">vim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;e&quot;, [[&lt;Cmd&gt;execute 'e ' .. expand('%:p:h')&lt;CR&gt;]], { noremap = true, desc = &quot;Explore&quot; })\nvim.api.nvim_set_keymap(\n\t'n',\n\t'-',\n\t[[&lt;Cmd&gt;execute 'e ' .. expand('%:p:h')&lt;CR&gt;]],\n\t{ noremap = true }\n)\n</code></pre>\n<ul>\n<li>harpoon</li>\n</ul>\n<pre><code class=\"language-lua\">require(&quot;harpoon&quot;).setup({\n\tmenu = {\n\t\twidth = vim.api.nvim_win_get_width(0) - 100,\n\t}\n})\n\nlocal mark = require(&quot;harpoon.mark&quot;)\nlocal ui = require(&quot;harpoon.ui&quot;)\n\nvim.keymap.set(&quot;n&quot;, &quot;&lt;C-m&gt;&quot;, mark.add_file, { desc = &quot;Add to harpoon&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;C-h&gt;&quot;, ui.toggle_quick_menu, { desc = &quot;Harpoon menu&quot; })\n\nvim.keymap.set(&quot;n&quot;, &quot;&lt;C-j&gt;&quot;, function () ui.nav_file(1) end)\nvim.keymap.set(&quot;n&quot;, &quot;&lt;C-k&gt;&quot;, function () ui.nav_file(2) end)\nvim.keymap.set(&quot;n&quot;, &quot;&lt;C-l&gt;&quot;, function () ui.nav_file(3) end)\n</code></pre>\n<ul>\n<li>Floaterm</li>\n</ul>\n<pre><code class=\"language-lua\">vim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;gg&quot;, &quot;&lt;cmd&gt;FloatermNew --width=0.99 --height=0.99 lazygit&lt;CR&gt;&quot;, { desc = &quot;Lazygit&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;E&quot;, &quot;&lt;cmd&gt;FloatermNew --width=0.99 --height=0.99 lf&lt;CR&gt;&quot;, { desc = &quot;LF&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;t&quot;, &quot;&lt;cmd&gt;FloatermNew --width=0.99 --height=0.99 bash&lt;CR&gt;&quot;, { desc = &quot;Terminal&quot; })\n</code></pre>\n<ul>\n<li>Wiki</li>\n</ul>\n<pre><code class=\"language-lua\">vim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wf&quot;, &quot;&lt;cmd&gt;Telescope find_files cwd=~/wiki/&lt;cr&gt;&quot;, { desc = &quot;Find File&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wg&quot;, &quot;&lt;cmd&gt;Telescope live_grep cwd=~/wiki/&lt;cr&gt;&quot;, { desc = &quot;Grep&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wq&quot;, &quot;&lt;cmd&gt;e ~/wiki/quick-note.md&lt;cr&gt;&quot;, { desc = &quot;Quick note&quot; })\n\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wt&quot;, string.format(&quot;&lt;cmd&gt;e ~/wiki/diary/%s/%s.md&lt;cr&gt;&quot;, os.date(&quot;%Y&quot;), os.date(&quot;%Y-%m-%d&quot;)), { desc = &quot;Today note&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wT&quot;, string.format(&quot;&lt;cmd&gt;e ~/wiki/diary/%s/%s.md&lt;cr&gt;&quot;, os.date(&quot;%Y&quot;), os.date(&quot;%Y-%m-%d&quot;), os.time() + 24 * 60 * 60), { desc = &quot;Tomorrow note&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wy&quot;, string.format(&quot;&lt;cmd&gt;e ~/wiki/diary/%s/%s.md&lt;cr&gt;&quot;, os.date(&quot;%Y&quot;), os.date(&quot;%Y-%m-%d&quot;), os.time() - 24 * 60 * 60), { desc = &quot;Yesterday note&quot; })\n\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wdf&quot;, string.format(&quot;&lt;cmd&gt;Telescope find_files cwd=~/wiki/diary/%s/&lt;cr&gt;&quot;, os.date(&quot;%Y&quot;)), { desc = &quot;Find diary year&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wdF&quot;, &quot;&lt;cmd&gt;Telescope find_files cwd=~/wiki/diary/&lt;cr&gt;&quot;, { desc = &quot;Find all diary&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wdg&quot;, string.format(&quot;&lt;cmd&gt;Telescope live_grep cwd=~/wiki/diary/%s/&lt;cr&gt;&quot;, os.date(&quot;%Y&quot;)), { desc = &quot;Grep diary year&quot; })\nvim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;wdG&quot;, &quot;&lt;cmd&gt;Telescope live_grep cwd=~/wiki/diary/&lt;cr&gt;&quot;, { desc = &quot;Grep all diary&quot; })\n</code></pre>\n<ul>\n<li>Custom build key</li>\n</ul>\n<pre><code class=\"language-lua\">vim.keymap.set(&quot;n&quot;, &quot;&lt;Space&gt;b&quot;, ':! cd md_to_json &amp;&amp; cargo run&lt;CR&gt;', { desc = &quot;Build&quot; })\n</code></pre>\n<h2>LSP</h2>\n<p>I use <strong>Mason</strong> to manage LSP, DAP, Linter and Formatter related plugins.\nI use <strong>lsp-zero</strong> to auto configure all LSP.\n<strong>cmp</strong> is another thing that need to be configured with LSP.\nI use <strong>mason-null-ls</strong> to help with formatter configuration.</p>\n<p>I use <strong>PHP</strong> with <strong>phpactor</strong> and it doesnot have formatter so, I use <strong>null-ls</strong> to configure <strong>phpcsfixer</strong> to format PHP files.</p>\n<pre><code class=\"language-lua\">require('mason.settings').set({\n\tui = {\n\t\tborder = 'rounded'\n\t}\n})\n\nlocal lsp = require('lsp-zero')\n\nlsp.preset('recommended')\n\nlsp.ensure_installed({})\n\nlsp.nvim_workspace()\n\nlocal cmp = require('cmp')\nlocal cmp_select = { behavior = cmp.SelectBehavior.Select }\nlocal cmp_mappings = lsp.defaults.cmp_mappings({\n\t['&lt;C-p&gt;'] = cmp.mapping.select_prev_item(cmp_select),\n\t['&lt;C-n&gt;'] = cmp.mapping.select_next_item(cmp_select),\n\t['&lt;C-y&gt;'] = cmp.mapping.confirm({ select = true }),\n\t['&lt;C-Space'] = cmp.mapping.complete(),\n})\n\nlsp.setup_nvim_cmp({\n\tmapping = cmp_mappings,\n})\n\nlsp.set_preferences({\n\tsuggest_lsp_servers = true,\n\tsetup_servers_on_start = true,\n\tset_lsp_keymaps = false,\n\tconfigure_diagnostics = true,\n\tcmp_capabilities = true,\n\tmanage_nvim_cmp = true,\n\tcall_servers = 'local',\n\tsign_icons = {\n\t\terror = '✘',\n\t\twarn = '▲',\n\t\thint = '⚑',\n\t\tinfo = ''\n\t}\n})\n\nlsp.on_attach(function(client, bufnr)\n\tif client.name == &quot;phpcsfixer&quot; then\n\t\tclient.server_capabilities.documentFormattingProvider = false -- 0.8 and later\n\tend\n    local nmap = function(keys, func, desc)\n\t\tvim.keymap.set('n', keys, func, { buffer = bufnr, desc = desc })\n\tend\n\n\tnmap(&quot;&lt;leader&gt;lf&quot;, function() vim.lsp.buf.format({ async = true }) end, &quot;Format&quot;)\n\n    -- other things...\nend)\n\nlsp.setup()\n\nvim.diagnostic.config({\n\tvirtual_text = true,\n\tsigns = true,\n\tupdate_in_insert = false,\n\tunderline = true,\n\tseverity_sort = false,\n\tfloat = true,\n})\n\nlocal mason_nullls = require(&quot;mason-null-ls&quot;)\n\nmason_nullls.setup({\n\tdebug = true,\n\tautomatic_installation = true,\n\tautomatic_setup = true,\n})\n\nlocal null_ls = require(&quot;null-ls&quot;);\nnull_ls.setup({\n\tdebug = true,\n\tsources = {\n\t\tnull_ls.builtins.formatting.phpcsfixer.with({\n\t\t\tfiletypes = { &quot;html&quot;, &quot;php&quot;, &quot;phtml&quot; },\n\t\t}),\n\t}\n})\n\nmason_nullls.setup_handlers()\n\nrequire &quot;lsp_signature&quot;.setup({})\n</code></pre>\n<p>DAP can also be configured also with LSP.</p>\n<pre><code class=\"language-lua\">local dap = require('dap')\ndap.adapters.php = {\n\ttype = 'executable',\n\tcommand = 'node',\n\targs = { os.getenv(&quot;HOME&quot;) .. &quot;/.local/share/nvim/mason/packages/php-debug-adapter/extension/out/phpDebug.js&quot; }\n}\n\ndap.configurations.php = {\n\t{\n\t\ttype = 'php',\n\t\trequest = 'launch',\n\t\tname = 'Listen for Xdebug',\n\t\thostname = 'fpm',\n\t\tport = 9000\n\t}\n}\n\nrequire(&quot;dapui&quot;).setup()\n</code></pre>\n<p>Trouble</p>\n<pre><code class=\"language-lua\">vim.keymap.set(&quot;n&quot;, &quot;&lt;leader&gt;xx&quot;, &quot;&lt;cmd&gt;TroubleToggle&lt;cr&gt;&quot;,\n\t{ silent = true, noremap = true }\n)\n</code></pre>\n","path":"neovim","sort_order":1677035700}